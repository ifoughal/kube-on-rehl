
# The Gateway API does not natively support L4 routing per hostname â€” only L7 and TLS-SNI.
# therefore, we cannot match on hostnames, but on a unique port with a unique IP...
# TCP ROUTES are not supported: REF: https://github.com/cilium/cilium/issues/21929
---
apiVersion: gateway.networking.k8s.io/v1alpha2
kind: TLSRoute
metadata:
  name: kafka-cluster-broker-10
  namespace: strimzi-kafka
spec:
  hostnames:
  - kafka-broker-0.pfs.pack
  parentRefs:
  - name: shared-https-gateway
    namespace: kube-system
    sectionName: kafka-tls-passthrough
  rules:
  - backendRefs:
    - name: kafka-cluster-broker-a-sasltls-10
      namespace: strimzi-kafka
      port: 9095
# ---
# apiVersion: gateway.networking.k8s.io/v1alpha2
# kind: TLSRoute
# metadata:
#   name: kafka-cluster-broker-11
#   namespace: strimzi-kafka
# spec:
#   hostnames:
#   - kafka-broker-1.pfs.pack
#   parentRefs:
#   - name: shared-https-gateway
#     namespace: kube-system
#     sectionName: kafka-tls-passthrough
#   rules:
#   - backendRefs:
#     - group: gateway.networking.k8s.io
#       kind: Service
#       name: kafka-cluster-broker-externaltls-11
#       namespace: strimzi-kafka
#       port: 9093
# ---
# apiVersion: gateway.networking.k8s.io/v1alpha2
# kind: TLSRoute
# metadata:
#   name: kafka-cluster-broker-12
#   namespace: strimzi-kafka
# spec:
#   hostnames:
#   - kafka-broker-2.pfs.pack
#   parentRefs:
#   - name: shared-https-gateway
#     namespace: kube-system
#     sectionName: kafka-tls-passthrough
#   rules:
#   - backendRefs:
#     - group: gateway.networking.k8s.io
#       kind: Service
#       name: kafka-cluster-broker-externaltls-12
#       namespace: strimzi-kafka
#       port: 9093
# ---
# apiVersion: gateway.networking.k8s.io/v1alpha2
# kind: TLSRoute
# metadata:
#   name: kafka-cluster-bootstrap
#   namespace: strimzi-kafka
# spec:
#   hostnames:
#   - kafka-bootstrap.pfs.pack
#   parentRefs:
#   - name: shared-https-gateway
#     namespace: kube-system
#     sectionName: kafka-tls-passthrough
#   rules:
#   - backendRefs:
#     - group: gateway.networking.k8s.io
#       kind: Service
#       name: kafka-cluster-kafka-externaltls-bootstrap
#       namespace: strimzi-kafka
#       port: 9093

# nc -zv kafka-broker-0.pfs.pack 9092
